<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cut Tracker — Baseline</title>
<link rel="stylesheet" href="shared.css">
</head>
<body>

<div style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 8px;">
  <div class="header animate" style="margin-bottom: 0;">
    <h1>Cut Tracker</h1>
    <span class="tag">Active Cut</span>
    <span class="med-badge">&#x1F489; Tirzepatide 2.5–3.5mg · wk 2</span>
  </div>
  <a href="nutrition.html" class="nav-link animate">Nutrition →</a>
</div>
<div class="subheader animate">
  Jan 23 → ~Apr 7, 2026 <span>·</span> Week 5 of 11 <span>·</span> 203.0 → 188.0 target <span>·</span> Rate adjusted to ~1.3 lb/wk
</div>

<!-- KPI Strip -->
<div id="kpi-strip" class="kpi-strip animate">
  <div class="kpi">
    <div class="kpi-label">Current</div>
    <div class="kpi-value">193.6</div>
    <div class="kpi-unit">lbs</div>
  </div>
  <div class="kpi">
    <div class="kpi-label">7-Day Avg</div>
    <div class="kpi-value">195.2</div>
    <div class="kpi-unit">lbs</div>
  </div>
  <div class="kpi">
    <div class="kpi-label">Total Lost</div>
    <div class="kpi-value" style="color: var(--teal);">−9.4</div>
    <div class="kpi-delta down">▼ 4.6% body weight</div>
  </div>
  <div class="kpi">
    <div class="kpi-label">To Target</div>
    <div class="kpi-value">5.6</div>
    <div class="kpi-unit">lbs remaining</div>
  </div>
  <div class="kpi">
    <div class="kpi-label">Weekly Rate</div>
    <div class="kpi-value">1.9 <span style="font-size: 16px; color: var(--text-dim);">→ 1.3</span></div>
    <div class="kpi-delta down">adjusting down +300 cal</div>
  </div>
  <div class="kpi">
    <div class="kpi-label">ETA</div>
    <div class="kpi-value">~Apr 7</div>
    <div class="kpi-delta neutral">~6 weeks at new rate</div>
  </div>
</div>

<!-- Compact Nutrition Summary -->
<a id="nutrition-summary" href="nutrition.html" style="display: flex; justify-content: space-between; align-items: center; background: var(--surface); border-radius: 12px; padding: 16px 24px; border: 1px solid var(--border); margin-bottom: 32px; text-decoration: none; transition: border-color 0.2s;" class="animate">
  <div style="display: flex; align-items: center; gap: 12px;">
    <span class="dot teal" style="width: 8px; height: 8px; border-radius: 50; display: inline-block; background: var(--teal);"></span>
    <span id="nutrition-strip" style="font-family: 'JetBrains Mono', monospace; font-size: 13px; color: var(--text-dim);">Loading nutrition...</span>
  </div>
  <span style="font-family: 'JetBrains Mono', monospace; font-size: 11px; color: var(--text-muted);">OPEN →</span>
</a>

<!-- Weight Chart + Projection -->
<div class="chart-grid animate">
  <div class="chart-panel">
    <div class="chart-title">
      <span class="dot red"></span> Weight · Daily + 7-Day Avg
    </div>
    <svg id="weight-chart" viewBox="0 0 700 280" width="100%" height="280">
      <!-- Grid lines -->
      <line x1="40" y1="20" x2="40" y2="240" class="grid-line" />
      <line x1="40" y1="240" x2="680" y2="240" class="grid-line" />
      <line x1="40" y1="60" x2="680" y2="60" class="grid-line" stroke-dasharray="2 4" />
      <line x1="40" y1="100" x2="680" y2="100" class="grid-line" stroke-dasharray="2 4" />
      <line x1="40" y1="140" x2="680" y2="140" class="grid-line" stroke-dasharray="2 4" />
      <line x1="40" y1="180" x2="680" y2="180" class="grid-line" stroke-dasharray="2 4" />
      <line x1="40" y1="20" x2="680" y2="20" class="grid-line" stroke-dasharray="2 4" />

      <!-- Y-axis labels -->
      <text x="35" y="24" class="grid-label" text-anchor="end">204</text>
      <text x="35" y="64" class="grid-label" text-anchor="end">201</text>
      <text x="35" y="104" class="grid-label" text-anchor="end">198</text>
      <text x="35" y="144" class="grid-label" text-anchor="end">195</text>
      <text x="35" y="184" class="grid-label" text-anchor="end">192</text>
      <text x="35" y="228" class="grid-label" text-anchor="end">189</text>

      <!-- X-axis labels -->
      <text x="57" y="258" class="grid-label" text-anchor="middle">Jan 25</text>
      <text x="152" y="258" class="grid-label" text-anchor="middle">Feb 5</text>
      <text x="239" y="258" class="grid-label" text-anchor="middle">Feb 15</text>
      <text x="343" y="258" class="grid-label" text-anchor="middle">Feb 27</text>
      <text x="481" y="258" class="grid-label" text-anchor="middle">Mar 15</text>
      <text x="680" y="258" class="grid-label" text-anchor="middle">Apr 7</text>

      <!-- Target line at 188 -->
      <line x1="40" y1="220" x2="680" y2="220" class="target-line" stroke="var(--teal)" />
      <text x="684" y="224" class="annotation-label" fill="var(--teal)">188 TARGET</text>

      <!-- Tirzepatide start annotation (Feb 12, day 20) -->
      <line x1="213" y1="20" x2="213" y2="240" class="annotation-line" stroke="var(--amber)" />
      <text x="217" y="32" class="annotation-label" fill="var(--amber)">TIRZ START</text>

      <!-- Data points rendered dynamically by script -->
      <circle cx="57" cy="33.75" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="66" cy="40.63" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="75" cy="42.0" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="118" cy="73.63" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="127" cy="64.0" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="135" cy="72.25" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="144" cy="116.25" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="152" cy="90.13" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="196" cy="102.5" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="204" cy="90.13" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="213" cy="119.0" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="222" cy="102.5" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="230" cy="80.5" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="265" cy="116.25" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="274" cy="161.63" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="282" cy="131.38" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="291" cy="131.38" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="300" cy="142.38" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="308" cy="146.5" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="317" cy="128.63" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="325" cy="130.0" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="334" cy="147.88" r="3" fill="var(--accent)" opacity="0.4" />
      <circle cx="343" cy="163" r="3.5" fill="var(--accent)" stroke="var(--accent)" stroke-width="1" opacity="0.8" />

      <line x1="343" y1="160" x2="343" y2="240" class="annotation-line" stroke="var(--text)" opacity="0.3" />
      <text x="343" y="155" class="annotation-label" fill="var(--text)" text-anchor="middle" font-weight="600">TODAY</text>

      <polyline
        points="144,69.5 196,95.6 222,98.4 274,110.8 300,131.4 343,141"
        class="data-line"
        stroke="var(--accent)"
      />

      <polyline
        points="343,141 680,220"
        class="data-line target-line"
        stroke="var(--accent)"
        opacity="0.5"
      />
    </svg>
  </div>

  <div class="chart-panel">
    <div class="chart-title">
      <span class="dot teal"></span> Rate of Loss
    </div>
    <svg viewBox="0 0 280 300" width="100%" height="300">
      <rect x="120" y="15" width="65" height="250" rx="0" fill="var(--teal)" opacity="0.04" />
      <line x1="120" y1="15" x2="120" y2="265" stroke="var(--teal)" stroke-width="1" stroke-dasharray="3 3" opacity="0.3" />
      <line x1="185" y1="15" x2="185" y2="265" stroke="var(--teal)" stroke-width="1" stroke-dasharray="3 3" opacity="0.3" />
      <text x="152" y="10" class="annotation-label" fill="var(--teal)" text-anchor="middle" opacity="0.6">SAFE ZONE · 0.5–1% BW</text>

      <text x="55" y="282" class="grid-label" fill="var(--text-muted)" text-anchor="middle">0</text>
      <text x="120" y="282" class="grid-label" fill="var(--text-muted)" text-anchor="middle">1.0</text>
      <text x="185" y="282" class="grid-label" fill="var(--text-muted)" text-anchor="middle">2.0</text>
      <text x="250" y="282" class="grid-label" fill="var(--text-muted)" text-anchor="middle">3.0 lb</text>

      <text x="10" y="47" class="grid-label">Wk 1</text>
      <rect x="55" y="35" width="84.5" height="20" rx="3" fill="var(--teal)" opacity="0.25" />
      <text x="146" y="49" class="grid-label" fill="var(--teal)" font-weight="500">-1.3 lb</text>
      <text x="146" y="60" class="annotation-label" fill="var(--teal)" opacity="0.5">0.6% BW</text>

      <text x="10" y="97" class="grid-label">Wk 2</text>
      <rect x="55" y="85" width="169" height="20" rx="3" fill="var(--accent)" opacity="0.3" />
      <text x="230" y="99" class="grid-label" fill="var(--accent)" font-weight="500">-2.6 lb</text>
      <text x="230" y="110" class="annotation-label" fill="var(--accent)" opacity="0.6">1.3% BW</text>

      <text x="10" y="147" class="grid-label">Wk 3</text>
      <rect x="55" y="135" width="97.5" height="20" rx="3" fill="var(--teal)" opacity="0.25" />
      <text x="159" y="149" class="grid-label" fill="var(--teal)" font-weight="500">-1.5 lb</text>
      <text x="159" y="160" class="annotation-label" fill="var(--teal)" opacity="0.5">0.8% BW</text>

      <text x="10" y="197" class="grid-label">Wk 4</text>
      <rect x="55" y="185" width="136.5" height="20" rx="3" fill="var(--amber)" opacity="0.3" />
      <text x="198" y="199" class="grid-label" fill="var(--amber)" font-weight="500">-2.1 lb</text>
      <text x="198" y="210" class="annotation-label" fill="var(--amber)" opacity="0.5">1.1% BW</text>

      <text x="10" y="247" class="grid-label" fill="var(--text-dim)">Wk 5</text>
      <rect x="55" y="235" width="45.5" height="20" rx="3" fill="var(--teal)" opacity="0.2" />
      <text x="107" y="249" class="grid-label" fill="var(--text-dim)">-0.7 lb</text>
      <text x="107" y="260" class="annotation-label" fill="var(--text-dim)">0.4% BW · 4 days in</text>
    </svg>
  </div>
</div>

<!-- Recovery Markers -->
<div id="recovery-grid" class="recovery-grid animate">
  <div class="recovery-metric">
    <div class="chart-title"><span class="dot blue"></span> Resting Heart Rate</div>
    <div class="kpi-value" style="font-size: 24px;">49.4 <span class="kpi-unit">bpm</span></div>
    <div class="kpi-delta neutral" style="margin-top: 4px;">30-day avg · Excellent range</div>
    <div class="gauge-bar">
      <div class="gauge-fill" style="width: 25%; background: var(--blue);"></div>
    </div>
    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
      <span class="grid-label" style="color: var(--text-muted); font-size: 9px;">40</span>
      <span class="grid-label" style="color: var(--text-muted); font-size: 9px;">⚠ 55+</span>
      <span class="grid-label" style="color: var(--text-muted); font-size: 9px;">80</span>
    </div>
  </div>

  <div class="recovery-metric">
    <div class="chart-title"><span class="dot teal"></span> HRV (RMSSD)</div>
    <div class="kpi-value" style="font-size: 24px;">65.1 <span class="kpi-unit">ms</span></div>
    <div class="kpi-delta down" style="margin-top: 4px;">7-day avg · Good range · ↑ 0.4</div>
    <div class="gauge-bar">
      <div class="gauge-fill" style="width: 55%; background: var(--teal);"></div>
    </div>
    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
      <span class="grid-label" style="color: var(--text-muted); font-size: 9px;">20</span>
      <span class="grid-label" style="color: var(--text-muted); font-size: 9px;">⚠ &lt;50</span>
      <span class="grid-label" style="color: var(--text-muted); font-size: 9px;">120</span>
    </div>
  </div>

  <div class="recovery-metric">
    <div class="chart-title"><span class="dot amber"></span> Sleep Duration</div>
    <div class="kpi-value" style="font-size: 24px;">6.6 <span class="kpi-unit">hrs</span></div>
    <div class="kpi-delta up" style="margin-top: 4px;">30-day avg · Below 7hr target</div>
    <div class="gauge-bar">
      <div class="gauge-fill" style="width: 62%; background: var(--amber);"></div>
    </div>
    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
      <span class="grid-label" style="color: var(--text-muted); font-size: 9px;">4</span>
      <span class="grid-label" style="color: var(--text-muted); font-size: 9px;">⚠ &lt;7</span>
      <span class="grid-label" style="color: var(--text-muted); font-size: 9px;">10</span>
    </div>
  </div>

  <div class="recovery-metric">
    <div class="chart-title"><span class="dot red"></span> Sleep Regularity</div>
    <div class="kpi-value" style="font-size: 24px;">±113 <span class="kpi-unit">min</span></div>
    <div class="kpi-delta up" style="margin-top: 4px;">Bedtime stdev · Concerning · ↑ 2.6</div>
    <div class="gauge-bar">
      <div class="gauge-fill" style="width: 85%; background: var(--accent);"></div>
    </div>
    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
      <span class="grid-label" style="color: var(--text-muted); font-size: 9px;">15</span>
      <span class="grid-label" style="color: var(--text-muted); font-size: 9px;">⚠ 60+</span>
      <span class="grid-label" style="color: var(--text-muted); font-size: 9px;">180</span>
    </div>
  </div>
</div>

<!-- Cut Timeline -->
<div class="timeline animate">
  <div class="chart-title">Cut Timeline</div>
  <div style="position: relative; height: 60px; margin-top: 8px;">
    <div style="position: absolute; top: 22px; left: 0; right: 0; height: 6px; background: var(--surface-2); border-radius: 3px;"></div>
    <div style="position: absolute; top: 22px; left: 0; width: 62%; height: 6px; background: linear-gradient(90deg, var(--accent), var(--teal)); border-radius: 3px;"></div>
    <div style="position: absolute; top: 14px; left: 62%; width: 2px; height: 22px; background: var(--text); transform: translateX(-50%); border-radius: 1px;"></div>
    <div style="position: absolute; top: 0; left: 62%; transform: translateX(-50%); font-family: 'JetBrains Mono', monospace; font-size: 10px; color: var(--text); font-weight: 600;">NOW · 193.6</div>
    <div style="position: absolute; top: 38px; left: 0; font-family: 'JetBrains Mono', monospace; font-size: 10px; color: var(--text-muted);">Jan 23 · 203.0</div>
    <div style="position: absolute; top: 14px; left: 27%; width: 1px; height: 22px; background: var(--amber); opacity: 0.5;"></div>
    <div style="position: absolute; top: 38px; left: 27%; transform: translateX(-50%); font-family: 'JetBrains Mono', monospace; font-size: 9px; color: var(--amber);">TIRZ</div>
    <div style="position: absolute; top: 38px; right: 0; font-family: 'JetBrains Mono', monospace; font-size: 10px; color: var(--teal);">~Apr 7 · 188.0</div>
  </div>
</div>

<!-- Strength Section -->
<div class="section-divider"></div>
<div class="section-header animate">Strength</div>
<div class="subheader animate" style="margin-bottom: 24px;">
  20 years lifting <span>·</span> Peak years 27–29 <span>·</span> Currently in deficit
</div>

<div class="strength-grid animate">
  <!-- Left: DOTS Score -->
  <div class="strength-panel" style="display: flex; flex-direction: column; justify-content: center;">
    <div class="chart-title" style="justify-content: center;">
      <span class="dot teal"></span> DOTS Score
    </div>
    <div class="dots-display">
      <div class="dots-number">267</div>
      <div class="dots-label">Current Estimated</div>
      <div style="margin-top: 8px;">
        <span class="annotation-label" style="color: var(--text-muted);">ALL-TIME PEAK: </span>
        <span class="annotation-label" style="color: var(--teal);">~299</span>
      </div>
    </div>

    <div class="dots-breakdown">
      <div class="dots-item">
        <div class="dots-item-value" style="color: var(--blue);">227</div>
        <div class="dots-item-label">Deadlift</div>
      </div>
      <div class="dots-item">
        <div class="dots-item-value" style="color: var(--amber);">—</div>
        <div class="dots-item-label">Squat</div>
      </div>
      <div class="dots-item">
        <div class="dots-item-value" style="color: var(--accent);">126</div>
        <div class="dots-item-label">Bench</div>
      </div>
    </div>

    <div style="margin-top: 20px; padding: 12px 16px; background: var(--surface-2); border-radius: 8px;">
      <div class="annotation-label" style="color: var(--text-dim); line-height: 1.6;">
        DOTS normalizes strength across body weights.<br>
        267 = Advanced recreational lifter.<br>
        Updates as weight drops + lifts are logged.<br>
        <span style="color: var(--teal);">Target: DOTS ↑ as BW ↓ if strength holds.</span>
      </div>
    </div>
  </div>

  <!-- Right: Lift comparison bars -->
  <div class="strength-panel">
    <div class="chart-title">
      <span class="dot blue"></span> Current vs All-Time · Est. 1RM
    </div>

    <!-- Deadlift -->
    <div class="lift-row">
      <div class="lift-name" style="color: var(--text);">Deadlift</div>
      <div class="lift-bar-container">
        <div class="lift-bar-bg"></div>
        <div class="lift-bar-peak" style="width: 100%; background: var(--blue);"></div>
        <div class="lift-bar-current" style="width: 90.9%; background: var(--blue);"></div>
        <div class="lift-bar-marker" style="left: 100%; background: var(--text-muted);"></div>
      </div>
      <div class="lift-value" style="color: var(--blue);">~500</div>
      <div class="lift-pct" style="color: var(--teal);">91%</div>
    </div>

    <!-- Squat -->
    <div class="lift-row">
      <div class="lift-name" style="color: var(--text);">Squat</div>
      <div class="lift-bar-container">
        <div class="lift-bar-bg"></div>
        <div class="lift-bar-peak" style="width: 77.3%; background: var(--amber);"></div>
        <div class="lift-bar-current" style="width: 63.6%; background: var(--amber);"></div>
        <div class="lift-bar-marker" style="left: 77.3%; background: var(--text-muted);"></div>
      </div>
      <div class="lift-value" style="color: var(--amber);">TBD</div>
      <div class="lift-pct" style="color: var(--text-dim);">—</div>
    </div>

    <!-- Bench -->
    <div class="lift-row">
      <div class="lift-name" style="color: var(--text);">Bench</div>
      <div class="lift-bar-container">
        <div class="lift-bar-bg"></div>
        <div class="lift-bar-peak" style="width: 57.3%; background: var(--accent);"></div>
        <div class="lift-bar-current" style="width: 50.5%; background: var(--accent);"></div>
        <div class="lift-bar-marker" style="left: 57.3%; background: var(--text-muted);"></div>
      </div>
      <div class="lift-value" style="color: var(--accent);">~278</div>
      <div class="lift-pct" style="color: var(--amber);">88%</div>
    </div>

    <!-- Total -->
    <div class="lift-row" style="border-top: 1px solid var(--border); margin-top: 4px; padding-top: 18px;">
      <div class="lift-name" style="color: var(--text-dim);">Total</div>
      <div class="lift-bar-container">
        <div class="lift-bar-bg"></div>
        <div class="lift-bar-peak" style="width: 100%; background: var(--text-dim);"></div>
        <div class="lift-bar-current" style="width: 87.4%; background: var(--text);"></div>
        <div class="lift-bar-marker" style="left: 100%; background: var(--text-muted);"></div>
      </div>
      <div class="lift-value" style="color: var(--text);">~1,128</div>
      <div class="lift-pct" style="color: var(--amber);">87%</div>
    </div>

    <div style="margin-top: 12px; display: flex; align-items: center; gap: 16px;">
      <div style="display: flex; align-items: center; gap: 6px;">
        <div style="width: 20px; height: 6px; border-radius: 3px; opacity: 0.6; background: var(--text-dim);"></div>
        <span class="annotation-label" style="color: var(--text-muted);">CURRENT EST. 1RM</span>
      </div>
      <div style="display: flex; align-items: center; gap: 6px;">
        <div style="width: 2px; height: 12px; border-radius: 1px; background: var(--text-muted); opacity: 0.4;"></div>
        <span class="annotation-label" style="color: var(--text-muted);">ALL-TIME PEAK</span>
      </div>
    </div>
  </div>
</div>

<!-- Recent Lifts Log -->
<div id="recent-lifts" class="strength-grid animate" style="grid-template-columns: 1fr;">
  <div class="strength-panel">
    <div class="chart-title">
      <span class="dot teal"></span> Recent Lifts
    </div>
    <div style="display: grid; grid-template-columns: 90px 120px 80px 60px 50px 1fr; gap: 8px; align-items: center;">
      <div class="annotation-label" style="color: var(--text-muted);">DATE</div>
      <div class="annotation-label" style="color: var(--text-muted);">EXERCISE</div>
      <div class="annotation-label" style="color: var(--text-muted);">WEIGHT</div>
      <div class="annotation-label" style="color: var(--text-muted);">REPS</div>
      <div class="annotation-label" style="color: var(--text-muted);">RPE</div>
      <div class="annotation-label" style="color: var(--text-muted);">EST. 1RM</div>

      <div style="font-family: 'JetBrains Mono', monospace; font-size: 12px; color: var(--text-dim);">Feb 5</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 12px; color: var(--blue);">DEADLIFT</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600;">476 lb</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px;">×1</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 12px; color: var(--text-dim);">8.5</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; color: var(--blue);">~500 lb</div>

      <div style="font-family: 'JetBrains Mono', monospace; font-size: 12px; color: var(--text-dim);">Feb 26</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 12px; color: var(--accent);">BENCH</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600;">255 lb</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px;">×3</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 12px; color: var(--text-dim);">9</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; color: var(--accent);">~278 lb</div>
    </div>

    <div style="margin-top: 16px; padding: 10px 14px; background: var(--amber-dim); border-radius: 6px; display: flex; align-items: center; gap: 8px;">
      <span style="font-size: 14px;">&#x26A0;</span>
      <span class="annotation-label" style="color: var(--amber);">SQUAT 1RM NEEDED — Log a set post-cut to complete the total and unlock DOTS tracking</span>
    </div>
  </div>
</div>

<!-- Protocol & Context -->
<div class="section-divider"></div>
<div class="section-header animate">Protocol</div>

<div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1px; background: var(--border); border-radius: 12px; overflow: hidden; margin-top: 16px; margin-bottom: 32px;" class="animate">

  <!-- Medications -->
  <div style="background: var(--surface); padding: 24px;">
    <div class="chart-title"><span class="dot amber"></span> Active Medications</div>
    <div style="display: flex; flex-direction: column; gap: 14px;">
      <div>
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600; color: var(--amber);">Tirzepatide</div>
        <div style="font-size: 12px; color: var(--text-dim); margin-top: 2px;">2.5–3.5mg/week · Started ~Feb 12</div>
        <div style="font-size: 11px; color: var(--text-muted); margin-top: 2px;">Cut-only. Appetite suppression + GLP-1 insulin sensitization.</div>
      </div>
      <div>
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600; color: var(--text-dim);">THC</div>
        <div style="font-size: 12px; color: var(--text-dim); margin-top: 2px;">10–20mg nightly</div>
        <div style="font-size: 11px; color: var(--text-muted); margin-top: 2px;">Sleep onset + hunger management. Suppresses REM, may blunt HRV.</div>
      </div>
      <div>
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600; color: var(--text-dim);">Finasteride</div>
        <div style="font-size: 12px; color: var(--text-dim); margin-top: 2px;">1.2mg daily · Ongoing</div>
      </div>
      <div>
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600; color: var(--text-dim);">Creatine</div>
        <div style="font-size: 12px; color: var(--text-dim); margin-top: 2px;">5g daily · To stage</div>
        <div style="font-size: 11px; color: var(--text-muted); margin-top: 2px;">Expect +2-3 lbs water weight (intramuscular, not fat).</div>
      </div>
      <div>
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600; color: var(--text-dim);">Caffeine</div>
        <div style="font-size: 12px; color: var(--text-dim); margin-top: 2px;">200mg target · AM only (Celsius)</div>
        <div style="font-size: 11px; color: var(--text-muted); margin-top: 2px;">Tapering from 400mg. 3mg/kg optimal = 264mg. Cortisol + sleep benefit below 300.</div>
      </div>
      <div>
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600; color: var(--text-dim);">LMNT</div>
        <div style="font-size: 12px; color: var(--text-dim); margin-top: 2px;">1-2 packs/day · Down from 3</div>
        <div style="font-size: 11px; color: var(--text-muted); margin-top: 2px;">1000mg Na/pack. Monitor once BP data available.</div>
      </div>
    </div>
  </div>

  <!-- Nutrition -->
  <div style="background: var(--surface); padding: 24px;">
    <div class="chart-title"><span class="dot teal"></span> Nutrition Strategy</div>
    <div style="display: flex; flex-direction: column; gap: 14px;">
      <div>
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600; color: var(--teal);">Protein Target</div>
        <div style="font-size: 12px; color: var(--text-dim); margin-top: 2px;">190g+/day (1g/lb) · Needs auditing</div>
      </div>
      <div>
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600; color: var(--text-dim);">Pre-Workout</div>
        <div style="font-size: 12px; color: var(--text-dim); margin-top: 2px;">3 bananas (~80g carbs) · 30-45 min before session</div>
        <div style="font-size: 11px; color: var(--text-muted); margin-top: 2px;">2 bananas = only 55g. Need glucose available at session start.</div>
      </div>
      <div>
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600; color: var(--text-dim);">Deficit Timing</div>
        <div style="font-size: 12px; color: var(--text-dim); margin-top: 2px;">Front-load deficit earlier in day</div>
        <div style="font-size: 11px; color: var(--text-muted); margin-top: 2px;">Bigger last meal → more tryptophan → better sleep quality.</div>
      </div>
      <div style="padding: 10px 12px; background: var(--teal-dim); border-radius: 6px;">
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 11px; color: var(--teal);">REFEED PROTOCOL</div>
        <div style="font-size: 11px; color: var(--text-dim); margin-top: 4px;">2 days at maintenance (~2,800-3,000 cal). High carb, same protein. Train hard on refeed days. Expect 2-3 lb water bounce → resolves in 3 days.</div>
      </div>
      <div style="padding: 10px 12px; background: var(--surface-2); border-radius: 6px; margin-top: 4px;">
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 11px; color: var(--text-dim);">RATE ADJUSTMENT</div>
        <div style="font-size: 11px; color: var(--text-dim); margin-top: 4px;">+300 cal/day → ~1.3 lb/week. Extends cut by ~3 weeks but preserves muscle + gym performance. ETA ~Apr 7.</div>
      </div>
    </div>
  </div>

  <!-- Recovery & Watch Signals -->
  <div style="background: var(--surface); padding: 24px;">
    <div class="chart-title"><span class="dot red"></span> Watch Signals</div>
    <div style="display: flex; flex-direction: column; gap: 14px;">
      <div style="padding: 10px 12px; background: var(--surface-2); border-radius: 6px;">
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 11px; color: var(--text-muted);">SLOW DOWN IF:</div>
        <div style="font-size: 12px; color: var(--text-dim); margin-top: 6px; line-height: 1.7;">
          HRV drops below <span style="color: var(--accent); font-family: 'JetBrains Mono', monospace;">50ms</span> for 3+ days<br>
          RHR climbs above <span style="color: var(--accent); font-family: 'JetBrains Mono', monospace;">55bpm</span> sustained<br>
          Compound lifts drop <span style="color: var(--accent); font-family: 'JetBrains Mono', monospace;">&gt;10%</span> from current<br>
          Weekly loss exceeds <span style="color: var(--accent); font-family: 'JetBrains Mono', monospace;">1% BW</span> for 2+ weeks
        </div>
      </div>
      <div>
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600; color: var(--text-dim);">Sleep</div>
        <div style="font-size: 12px; color: var(--text-dim); margin-top: 2px;">6.6 hrs avg · ±110 min regularity</div>
        <div style="font-size: 11px; color: var(--text-muted); margin-top: 2px;">Weakest metric. Deficit + THC REM suppression compounding. Extra sleep > diet break for recovery.</div>
      </div>
      <div>
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600; color: var(--text-dim);">Nocturia</div>
        <div style="font-size: 12px; color: var(--text-dim); margin-top: 2px;">Since age 19-20 · Disrupts continuity</div>
        <div style="font-size: 11px; color: var(--text-muted); margin-top: 2px;">Fluid timing, fixed wake time, pelvic floor work.</div>
      </div>
      <div>
        <div style="font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: 600; color: var(--text-dim);">Family Hx</div>
        <div style="font-size: 12px; color: var(--text-dim); margin-top: 2px;">Dad: TIA. Uncle: CAD (bypass). Grandfather: arteriosclerosis.</div>
      </div>
    </div>
  </div>

</div>

<!-- Daily Check-in Format -->
<div style="background: var(--surface); border-radius: 12px; padding: 24px; border: 1px solid var(--border); margin-bottom: 32px;" class="animate">
  <div class="chart-title"><span class="dot blue"></span> Daily Check-in</div>
  <div style="font-size: 13px; color: var(--text-dim); margin-bottom: 16px;">Drop these 4 data points each day. 30 seconds. Dashboard updates automatically.</div>
  <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px;">
    <div style="padding: 14px; background: var(--surface-2); border-radius: 8px; text-align: center;">
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 20px; font-weight: 600;">&#x2696;</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 12px; font-weight: 600; color: var(--text); margin-top: 6px;">WEIGHT</div>
      <div style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">Morning, post-bathroom</div>
    </div>
    <div style="padding: 14px; background: var(--surface-2); border-radius: 8px; text-align: center;">
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 20px; font-weight: 600;">&#x1F969;</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 12px; font-weight: 600; color: var(--text); margin-top: 6px;">PROTEIN</div>
      <div style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">"Hit the template" or list swaps</div>
    </div>
    <div style="padding: 14px; background: var(--surface-2); border-radius: 8px; text-align: center;">
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 20px; font-weight: 600;">&#x1F3CB;</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 12px; font-weight: 600; color: var(--text); margin-top: 6px;">LIFT</div>
      <div style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">Exercise / weight / reps</div>
    </div>
    <div style="padding: 14px; background: var(--surface-2); border-radius: 8px; text-align: center;">
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 20px; font-weight: 600;">&#x1F4A4;</div>
      <div style="font-family: 'JetBrains Mono', monospace; font-size: 12px; font-weight: 600; color: var(--text); margin-top: 6px;">SLEEP</div>
      <div style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">Subjective quality 1-5</div>
    </div>
  </div>
  <div style="margin-top: 16px; padding: 10px 14px; background: var(--surface-2); border-radius: 6px;">
    <div style="font-family: 'JetBrains Mono', monospace; font-size: 11px; color: var(--text-dim);">
      EXAMPLE: "193.8, hit the template, swapped eggs for rotisserie, deadlift 485x1 @ RPE 8, sleep 3/5"
    </div>
  </div>
</div>

<script src="shared.js"></script>
<script>
(async function() {
  const [weightText, mealText, garminData, strengthText] = await Promise.all([
    safeFetch('../weight_log.csv'),
    safeFetch('../meal_log.csv'),
    safeFetch('../garmin_latest.json', true),
    safeFetch('../strength_log.csv'),
  ]);

  // ─── NUTRITION SUMMARY STRIP ───
  if (mealText) try {
    const allMeals = parseCSV(mealText);
    const meals = allMeals.filter(m => m.date === todayStr());
    if (meals.length) {
      const eaten = { protein: 0, carbs: 0, fat: 0, calories: 0 };
      meals.forEach(m => {
        eaten.protein += parseFloat(m.protein_g) || 0;
        eaten.carbs += parseFloat(m.carbs_g) || 0;
        eaten.fat += parseFloat(m.fat_g) || 0;
        eaten.calories += parseFloat(m.calories) || 0;
      });
      const ep = Math.round(eaten.protein), ec = Math.round(eaten.carbs), ef = Math.round(eaten.fat), ecal = Math.round(eaten.calories);
      const strip = document.getElementById('nutrition-strip');
      if (strip) {
        const pColor = ep >= CUT.macroTargets.protein ? 'var(--teal)' : 'var(--text)';
        const cColor = ec > CUT.macroTargets.carbs ? 'var(--accent)' : 'var(--text-dim)';
        const fColor = ef > CUT.macroTargets.fat ? 'var(--accent)' : 'var(--text-dim)';
        const calColor = ecal > CUT.macroTargets.calories ? 'var(--accent)' : 'var(--text-dim)';
        strip.innerHTML = `<span style="color:${pColor}">${ep}/${CUT.macroTargets.protein}g P</span> · <span style="color:${cColor}">${ec}/${CUT.macroTargets.carbs}g C</span> · <span style="color:${fColor}">${ef}/${CUT.macroTargets.fat}g F</span> · <span style="color:${calColor}">${ecal.toLocaleString()}/${CUT.macroTargets.calories.toLocaleString()} cal</span>`;
      }
    } else {
      const strip = document.getElementById('nutrition-strip');
      if (strip) strip.textContent = 'No meals logged today';
    }
  } catch(e) { console.warn('Nutrition summary failed:', e); }

  // ─── WEIGHT ───
  if (weightText) try {
    const weights = parseCSV(weightText)
      .map(r => ({ date: r.date, weight: parseFloat(r.weight_lbs) }))
      .filter(r => !isNaN(r.weight))
      .sort((a, b) => a.date.localeCompare(b.date));
    if (!weights.length) throw new Error('empty');

    const latest = weights[weights.length - 1];

    const avgs = weights.map((_, i, arr) => {
      const slice = arr.slice(Math.max(0, i - 6), i + 1);
      return slice.reduce((s, d) => s + d.weight, 0) / slice.length;
    });
    const avg7 = avgs[avgs.length - 1];
    const totalLost = latest.weight - CUT.startWeight;
    const toTarget = latest.weight - CUT.targetWeight;
    const pctLost = Math.abs(totalLost / CUT.startWeight * 100);
    const weeksIn = dayIndex(latest.date) / 7;
    const avgRate = weeksIn > 0 ? Math.abs(totalLost) / weeksIn : 0;
    const weeksRemaining = avgRate > 0 ? toTarget / avgRate : 99;
    const etaDate = new Date(latest.date + 'T00:00:00');
    etaDate.setDate(etaDate.getDate() + Math.round(weeksRemaining * 7));
    const etaStr = fmtDate(etaDate.toISOString().slice(0, 10));
    const currentWeek = Math.ceil(dayIndex(latest.date) / 7);

    const sub = document.querySelector('.subheader');
    if (sub) sub.innerHTML = `Jan 23 → ~${etaStr}, 2026 <span>·</span> Week ${currentWeek} of 11 <span>·</span> ${CUT.startWeight} → ${CUT.targetWeight} target <span>·</span> Rate ~${avgRate.toFixed(1)} lb/wk`;

    const kpis = document.querySelectorAll('#kpi-strip .kpi');
    if (kpis.length >= 6) {
      kpis[0].querySelector('.kpi-value').textContent = latest.weight.toFixed(1);
      kpis[1].querySelector('.kpi-value').textContent = avg7.toFixed(1);
      kpis[2].querySelector('.kpi-value').textContent = '−' + Math.abs(totalLost).toFixed(1);
      const delta2 = kpis[2].querySelector('.kpi-delta');
      if (delta2) delta2.textContent = '▼ ' + pctLost.toFixed(1) + '% body weight';
      kpis[3].querySelector('.kpi-value').textContent = toTarget.toFixed(1);
      kpis[4].querySelector('.kpi-value').textContent = avgRate.toFixed(1);
      const delta4 = kpis[4].querySelector('.kpi-delta');
      if (delta4) delta4.textContent = 'avg over ' + Math.round(weeksIn) + ' weeks';
      kpis[5].querySelector('.kpi-value').textContent = '~' + etaStr;
      const delta5 = kpis[5].querySelector('.kpi-delta');
      if (delta5) delta5.textContent = '~' + Math.ceil(weeksRemaining) + ' weeks remaining';
    }

    // Weight chart SVG
    const svg = document.getElementById('weight-chart');
    if (svg) {
      const ns = 'http://www.w3.org/2000/svg';
      svg.querySelectorAll('circle').forEach(c => c.remove());
      svg.querySelectorAll('polyline').forEach(p => p.remove());
      svg.querySelectorAll('text').forEach(t => {
        if (t.textContent.trim() === 'TODAY') t.remove();
      });
      svg.querySelectorAll('line').forEach(l => {
        if (l.getAttribute('stroke') === 'var(--text)') l.remove();
      });

      weights.forEach((d, i) => {
        const di = dayIndex(d.date);
        const cx = dayToX(di), cy = weightToY(d.weight);
        const isLast = i === weights.length - 1;
        const c = document.createElementNS(ns, 'circle');
        c.setAttribute('cx', cx.toFixed(1));
        c.setAttribute('cy', cy.toFixed(1));
        c.setAttribute('r', isLast ? '3.5' : '3');
        c.setAttribute('fill', 'var(--accent)');
        c.setAttribute('opacity', isLast ? '0.8' : '0.4');
        if (isLast) { c.setAttribute('stroke', 'var(--accent)'); c.setAttribute('stroke-width', '1'); }
        svg.appendChild(c);
      });

      const lx = dayToX(dayIndex(latest.date)), ly = weightToY(latest.weight);
      const tl2 = document.createElementNS(ns, 'line');
      tl2.setAttribute('x1', lx.toFixed(1)); tl2.setAttribute('y1', (ly - 3).toFixed(1));
      tl2.setAttribute('x2', lx.toFixed(1)); tl2.setAttribute('y2', '240');
      tl2.classList.add('annotation-line');
      tl2.setAttribute('stroke', 'var(--text)'); tl2.setAttribute('opacity', '0.3');
      svg.appendChild(tl2);
      const tt = document.createElementNS(ns, 'text');
      tt.setAttribute('x', lx.toFixed(1)); tt.setAttribute('y', (ly - 8).toFixed(1));
      tt.classList.add('annotation-label');
      tt.setAttribute('fill', 'var(--text)'); tt.setAttribute('text-anchor', 'middle');
      tt.setAttribute('font-weight', '600'); tt.textContent = 'TODAY';
      svg.appendChild(tt);

      if (weights.length >= 3) {
        const pts = [];
        for (let i = 2; i < weights.length; i++) {
          pts.push(dayToX(dayIndex(weights[i].date)).toFixed(1) + ',' + weightToY(avgs[i]).toFixed(1));
        }
        if (pts.length >= 2) {
          const pl = document.createElementNS(ns, 'polyline');
          pl.setAttribute('points', pts.join(' '));
          pl.classList.add('data-line');
          pl.setAttribute('stroke', 'var(--accent)');
          svg.appendChild(pl);
        }
      }

      const proj = document.createElementNS(ns, 'polyline');
      proj.setAttribute('points', `${lx.toFixed(1)},${weightToY(avg7).toFixed(1)} 680,${weightToY(CUT.targetWeight).toFixed(1)}`);
      proj.classList.add('data-line', 'target-line');
      proj.setAttribute('stroke', 'var(--accent)'); proj.setAttribute('opacity', '0.5');
      svg.appendChild(proj);
    }

    // Timeline
    const tl = document.querySelector('.timeline');
    if (tl) {
      const pct = (dayIndex(latest.date) / CUT.totalDays * 100);
      const pctStr = pct.toFixed(0) + '%';
      tl.querySelectorAll('div').forEach(d => {
        const s = d.style;
        if (s.background && s.background.includes('linear-gradient') && s.height === '6px') s.width = pctStr;
        if (s.height === '22px' && s.width === '2px') s.left = pctStr;
        if (d.textContent.includes('NOW')) { s.left = pctStr; d.textContent = 'NOW · ' + latest.weight.toFixed(1); }
      });
    }
  } catch(e) { console.warn('Weight update failed:', e); }

  // ─── RECOVERY (Garmin) ───
  if (garminData) try {
    const metrics = document.querySelectorAll('#recovery-grid .recovery-metric');
    if (metrics.length >= 4) {
      const rhr = garminData.resting_hr;
      if (rhr != null) {
        metrics[0].querySelector('.kpi-value').innerHTML = rhr.toFixed(1) + ' <span class="kpi-unit">bpm</span>';
        const fill0 = metrics[0].querySelector('.gauge-fill');
        if (fill0) fill0.style.width = Math.min(100, Math.max(0, (rhr - 40) / 40 * 100)).toFixed(0) + '%';
      }
      const hrv = garminData.hrv_rmssd_avg;
      if (hrv != null) {
        metrics[1].querySelector('.kpi-value').innerHTML = hrv.toFixed(1) + ' <span class="kpi-unit">ms</span>';
        const fill1 = metrics[1].querySelector('.gauge-fill');
        if (fill1) fill1.style.width = Math.min(100, Math.max(0, (hrv - 20) / 100 * 100)).toFixed(0) + '%';
      }
      const sleep = garminData.sleep_duration_avg;
      if (sleep != null) {
        metrics[2].querySelector('.kpi-value').innerHTML = sleep.toFixed(1) + ' <span class="kpi-unit">hrs</span>';
        const fill2 = metrics[2].querySelector('.gauge-fill');
        if (fill2) fill2.style.width = Math.min(100, Math.max(0, (sleep - 4) / 6 * 100)).toFixed(0) + '%';
        const desc2 = metrics[2].querySelector('.kpi-delta');
        if (desc2) desc2.textContent = '30-day avg · ' + (sleep < 7 ? 'Below 7hr target' : 'On target');
      }
      const reg = garminData.sleep_regularity_stddev;
      if (reg != null) {
        const rv = Math.round(reg);
        metrics[3].querySelector('.kpi-value').innerHTML = '±' + rv + ' <span class="kpi-unit">min</span>';
        const fill3 = metrics[3].querySelector('.gauge-fill');
        if (fill3) fill3.style.width = Math.min(100, Math.max(0, (rv - 15) / 165 * 100)).toFixed(0) + '%';
      }
    }
  } catch(e) { console.warn('Recovery update failed:', e); }

  // ─── STRENGTH ───
  if (strengthText) try {
    const lifts = parseCSV(strengthText).map(r => ({
      date: r.date,
      exercise: r.exercise,
      weight: parseFloat(r.weight_lbs),
      reps: parseInt(r.reps),
      rpe: parseFloat(r.rpe),
      notes: r.notes || ''
    })).filter(r => !isNaN(r.weight));

    function normLift(ex) {
      if (ex.includes('deadlift')) return 'deadlift';
      if (ex.includes('bench')) return 'bench';
      if (ex.includes('squat')) return 'squat';
      return ex;
    }

    const best = {};
    lifts.forEach(l => {
      const key = normLift(l.exercise);
      const e = est1RM(l.weight, l.reps, l.rpe);
      if (!best[key] || l.date > best[key].date || (l.date === best[key].date && e > best[key].e1rm)) {
        best[key] = { e1rm: e, date: l.date, raw: l };
      }
    });

    const rl = document.getElementById('recent-lifts');
    if (rl) {
      const grid = rl.querySelector('div[style*="grid-template-columns: 90px"]');
      if (grid) {
        const kids = Array.from(grid.children);
        grid.innerHTML = '';
        kids.slice(0, 6).forEach(h => grid.appendChild(h));

        [...lifts].sort((a, b) => b.date.localeCompare(a.date)).forEach(l => {
          const e = est1RM(l.weight, l.reps, l.rpe);
          const key = normLift(l.exercise);
          const color = LIFT_COLORS[key] || 'var(--text)';
          const label = l.exercise.toUpperCase().replace(/_/g, ' ');
          [
            `<div style="font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--text-dim)">${fmtDate(l.date)}</div>`,
            `<div style="font-family:'JetBrains Mono',monospace;font-size:12px;color:${color}">${label}</div>`,
            `<div style="font-family:'JetBrains Mono',monospace;font-size:13px;font-weight:600">${l.weight} lb</div>`,
            `<div style="font-family:'JetBrains Mono',monospace;font-size:13px">×${l.reps}</div>`,
            `<div style="font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--text-dim)">${l.rpe}</div>`,
            `<div style="font-family:'JetBrains Mono',monospace;font-size:13px;color:${color}">~${e} lb</div>`,
          ].forEach(html => {
            const wrap = document.createElement('div');
            wrap.innerHTML = html;
            grid.appendChild(wrap.firstElementChild);
          });
        });
      }
    }

    const currentBW = weightText
      ? parseCSV(weightText).map(r => parseFloat(r.weight_lbs)).filter(n => !isNaN(n)).pop()
      : null;

    if (currentBW) {
      const bwKg = currentBW * 0.453592;
      const a=-307.75076, b=24.0900756, c=-0.1918759221, d=0.0007391293, e=-0.000001093;
      const denom = a + b*bwKg + c*bwKg**2 + d*bwKg**3 + e*bwKg**4;
      const coeff = 500 / denom;

      const dl = best.deadlift?.e1rm || 0;
      const sq = best.squat?.e1rm || 0;
      const bp = best.bench?.e1rm || 0;
      const total = dl + sq + bp;
      const dots = Math.round(total * 0.453592 * coeff);

      const dotsNum = document.querySelector('.dots-number');
      if (dotsNum) dotsNum.textContent = dots;
      const dotsItems = document.querySelectorAll('.dots-item-value');
      if (dotsItems.length >= 3) {
        dotsItems[0].textContent = dl ? Math.round(dl * 0.453592 * coeff) : '—';
        dotsItems[1].textContent = sq ? Math.round(sq * 0.453592 * coeff) : '—';
        dotsItems[2].textContent = bp ? Math.round(bp * 0.453592 * coeff) : '—';
      }

      const maxPeak = CUT.peaks.deadlift;
      const liftData = [
        { e1rm: dl, peak: CUT.peaks.deadlift },
        { e1rm: sq, peak: CUT.peaks.squat },
        { e1rm: bp, peak: CUT.peaks.bench },
      ];
      const rows = document.querySelectorAll('.lift-row');
      liftData.forEach((lift, i) => {
        if (!rows[i]) return;
        const peakPct = (lift.peak / maxPeak * 100).toFixed(1);
        const curPct = lift.e1rm ? (lift.e1rm / maxPeak * 100).toFixed(1) : '0';
        const retPct = lift.e1rm ? Math.round(lift.e1rm / lift.peak * 100) : null;

        const pb = rows[i].querySelector('.lift-bar-peak'); if (pb) pb.style.width = peakPct + '%';
        const cb = rows[i].querySelector('.lift-bar-current'); if (cb) cb.style.width = curPct + '%';
        const mk = rows[i].querySelector('.lift-bar-marker'); if (mk) mk.style.left = peakPct + '%';
        const vl = rows[i].querySelector('.lift-value'); if (vl) vl.textContent = lift.e1rm ? '~' + lift.e1rm : 'TBD';
        const pc = rows[i].querySelector('.lift-pct'); if (pc) pc.textContent = retPct ? retPct + '%' : '—';
      });

      if (rows[3]) {
        const tPct = (total / CUT.peakTotal * 100).toFixed(1);
        const cb = rows[3].querySelector('.lift-bar-current'); if (cb) cb.style.width = tPct + '%';
        const vl = rows[3].querySelector('.lift-value'); if (vl) vl.textContent = '~' + total.toLocaleString();
        const pc = rows[3].querySelector('.lift-pct'); if (pc) pc.textContent = Math.round(total / CUT.peakTotal * 100) + '%';
      }
    }
  } catch(e) { console.warn('Strength update failed:', e); }

  console.log('Cut tracker: dynamic data loaded');
})();
</script>
</body>
</html>
